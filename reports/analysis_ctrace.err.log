Traceback (most recent call last):
  File "/home/tjhunter/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/tjhunter/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/tjhunter/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/tjhunter/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/tjhunter/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/tjhunter/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
px.bar(sdf
 .select(c_original_inventory_sector.value_counts(sort=True))
 .collect()
 .unnest(ORIGINAL_INVENTORY_SECTOR),
      x=ORIGINAL_INVENTORY_SECTOR, y="count", log_y=True)
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mModuleNotFoundError[0m                       Traceback (most recent call last)
File [0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/pandas/compat/_optional.py:135[0m, in [0;36mimport_optional_dependency[0;34m(name, extra, errors, min_version)[0m
[1;32m    134[0m [38;5;28;01mtry[39;00m:
[0;32m--> 135[0m     module [38;5;241m=[39m [43mimportlib[49m[38;5;241;43m.[39;49m[43mimport_module[49m[43m([49m[43mname[49m[43m)[49m
[1;32m    136[0m [38;5;28;01mexcept[39;00m [38;5;167;01mImportError[39;00m:

File [0;32m/usr/lib/python3.10/importlib/__init__.py:126[0m, in [0;36mimport_module[0;34m(name, package)[0m
[1;32m    125[0m         level [38;5;241m+[39m[38;5;241m=[39m [38;5;241m1[39m
[0;32m--> 126[0m [38;5;28;01mreturn[39;00m [43m_bootstrap[49m[38;5;241;43m.[39;49m[43m_gcd_import[49m[43m([49m[43mname[49m[43m[[49m[43mlevel[49m[43m:[49m[43m][49m[43m,[49m[43m [49m[43mpackage[49m[43m,[49m[43m [49m[43mlevel[49m[43m)[49m

File [0;32m<frozen importlib._bootstrap>:1050[0m, in [0;36m_gcd_import[0;34m(name, package, level)[0m

File [0;32m<frozen importlib._bootstrap>:1027[0m, in [0;36m_find_and_load[0;34m(name, import_)[0m

File [0;32m<frozen importlib._bootstrap>:1004[0m, in [0;36m_find_and_load_unlocked[0;34m(name, import_)[0m

[0;31mModuleNotFoundError[0m: No module named 'pyarrow'

During handling of the above exception, another exception occurred:

[0;31mImportError[0m                               Traceback (most recent call last)
File [0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/plotly/express/_core.py:1436[0m, in [0;36mbuild_dataframe[0;34m(args, constructor)[0m
[1;32m   1435[0m         columns [38;5;241m=[39m [38;5;28mlist[39m(necessary_columns)
[0;32m-> 1436[0m         args[[38;5;124m"[39m[38;5;124mdata_frame[39m[38;5;124m"[39m] [38;5;241m=[39m [43mpd[49m[38;5;241;43m.[39;49m[43mapi[49m[38;5;241;43m.[39;49m[43minterchange[49m[38;5;241;43m.[39;49m[43mfrom_dataframe[49m[43m([49m
[1;32m   1437[0m [43m            [49m[43margs[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mdata_frame[39;49m[38;5;124;43m"[39;49m[43m][49m[38;5;241;43m.[39;49m[43mselect_columns_by_name[49m[43m([49m[43mcolumns[49m[43m)[49m
[1;32m   1438[0m [43m        [49m[43m)[49m
[1;32m   1439[0m [38;5;28;01mexcept[39;00m ([38;5;167;01mImportError[39;00m, [38;5;167;01mNotImplementedError[39;00m) [38;5;28;01mas[39;00m exc:
[1;32m   1440[0m     [38;5;66;03m# temporary workaround; developers of third-party libraries themselves[39;00m
[1;32m   1441[0m     [38;5;66;03m# should try a different implementation, if available. For example:[39;00m
[1;32m   1442[0m     [38;5;66;03m# def __dataframe__(self, ...):[39;00m
[1;32m   1443[0m     [38;5;66;03m#   if not some_condition:[39;00m
[1;32m   1444[0m     [38;5;66;03m#     self.to_pandas(...)[39;00m

File [0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/pandas/core/interchange/from_dataframe.py:71[0m, in [0;36mfrom_dataframe[0;34m(df, allow_copy)[0m
[1;32m     69[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124m"[39m[38;5;124m`df` does not support __dataframe__[39m[38;5;124m"[39m)
[0;32m---> 71[0m [38;5;28;01mreturn[39;00m [43m_from_dataframe[49m[43m([49m
[1;32m     72[0m [43m    [49m[43mdf[49m[38;5;241;43m.[39;49m[43m__dataframe__[49m[43m([49m[43mallow_copy[49m[38;5;241;43m=[39;49m[43mallow_copy[49m[43m)[49m[43m,[49m[43m [49m[43mallow_copy[49m[38;5;241;43m=[39;49m[43mallow_copy[49m
[1;32m     73[0m [43m[49m[43m)[49m

File [0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/pandas/core/interchange/from_dataframe.py:94[0m, in [0;36m_from_dataframe[0;34m(df, allow_copy)[0m
[1;32m     93[0m [38;5;28;01mfor[39;00m chunk [38;5;129;01min[39;00m df[38;5;241m.[39mget_chunks():
[0;32m---> 94[0m     pandas_df [38;5;241m=[39m [43mprotocol_df_chunk_to_pandas[49m[43m([49m[43mchunk[49m[43m)[49m
[1;32m     95[0m     pandas_dfs[38;5;241m.[39mappend(pandas_df)

File [0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/pandas/core/interchange/from_dataframe.py:148[0m, in [0;36mprotocol_df_chunk_to_pandas[0;34m(df)[0m
[1;32m    147[0m [38;5;28;01melif[39;00m dtype [38;5;241m==[39m DtypeKind[38;5;241m.[39mSTRING:
[0;32m--> 148[0m     columns[name], buf [38;5;241m=[39m [43mstring_column_to_ndarray[49m[43m([49m[43mcol[49m[43m)[49m
[1;32m    149[0m [38;5;28;01melif[39;00m dtype [38;5;241m==[39m DtypeKind[38;5;241m.[39mDATETIME:

File [0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/pandas/core/interchange/from_dataframe.py:300[0m, in [0;36mstring_column_to_ndarray[0;34m(col)[0m
[1;32m    299[0m valid_buff, valid_dtype [38;5;241m=[39m buffers[[38;5;124m"[39m[38;5;124mvalidity[39m[38;5;124m"[39m]
[0;32m--> 300[0m null_pos [38;5;241m=[39m [43mbuffer_to_ndarray[49m[43m([49m
[1;32m    301[0m [43m    [49m[43mvalid_buff[49m[43m,[49m[43m [49m[43mvalid_dtype[49m[43m,[49m[43m [49m[43moffset[49m[38;5;241;43m=[39;49m[43mcol[49m[38;5;241;43m.[39;49m[43moffset[49m[43m,[49m[43m [49m[43mlength[49m[38;5;241;43m=[39;49m[43mcol[49m[38;5;241;43m.[39;49m[43msize[49m[43m([49m[43m)[49m
[1;32m    302[0m [43m[49m[43m)[49m
[1;32m    303[0m [38;5;28;01mif[39;00m sentinel_val [38;5;241m==[39m [38;5;241m0[39m:

File [0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/pandas/core/interchange/from_dataframe.py:445[0m, in [0;36mbuffer_to_ndarray[0;34m(buffer, dtype, length, offset)[0m
[1;32m    444[0m [38;5;28;01massert[39;00m length [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m, [38;5;124m"[39m[38;5;124m`length` must be specified for a bit-mask buffer.[39m[38;5;124m"[39m
[0;32m--> 445[0m pa [38;5;241m=[39m [43mimport_optional_dependency[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mpyarrow[39;49m[38;5;124;43m"[39;49m[43m)[49m
[1;32m    446[0m arr [38;5;241m=[39m pa[38;5;241m.[39mBooleanArray[38;5;241m.[39mfrom_buffers(
[1;32m    447[0m     pa[38;5;241m.[39mbool_(),
[1;32m    448[0m     length,
[1;32m    449[0m     [[38;5;28;01mNone[39;00m, pa[38;5;241m.[39mforeign_buffer(buffer[38;5;241m.[39mptr, length)],
[1;32m    450[0m     offset[38;5;241m=[39moffset,
[1;32m    451[0m )

File [0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/pandas/compat/_optional.py:138[0m, in [0;36mimport_optional_dependency[0;34m(name, extra, errors, min_version)[0m
[1;32m    137[0m [38;5;28;01mif[39;00m errors [38;5;241m==[39m [38;5;124m"[39m[38;5;124mraise[39m[38;5;124m"[39m:
[0;32m--> 138[0m     [38;5;28;01mraise[39;00m [38;5;167;01mImportError[39;00m(msg)
[1;32m    139[0m [38;5;28;01mreturn[39;00m [38;5;28;01mNone[39;00m

[0;31mImportError[0m: Missing optional dependency 'pyarrow'.  Use pip or conda to install pyarrow.

During handling of the above exception, another exception occurred:

[0;31mModuleNotFoundError[0m                       Traceback (most recent call last)
[0;32m/tmp/ipykernel_1880515/786101580.py[0m in [0;36m?[0;34m()[0m
[0;32m----> 1[0;31m px.bar(sdf
[0m[1;32m      2[0m  [0;34m.[0m[0mselect[0m[0;34m([0m[0mc_original_inventory_sector[0m[0;34m.[0m[0mvalue_counts[0m[0;34m([0m[0msort[0m[0;34m=[0m[0;32mTrue[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m      3[0m  [0;34m.[0m[0mcollect[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m      4[0m  [0;34m.[0m[0munnest[0m[0;34m([0m[0mORIGINAL_INVENTORY_SECTOR[0m[0;34m)[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/plotly/express/_chart_types.py[0m in [0;36m?[0;34m(data_frame, x, y, color, pattern_shape, facet_row, facet_col, facet_col_wrap, facet_row_spacing, facet_col_spacing, hover_name, hover_data, custom_data, text, base, error_x, error_x_minus, error_y, error_y_minus, animation_frame, animation_group, category_orders, labels, color_discrete_sequence, color_discrete_map, color_continuous_scale, pattern_shape_sequence, pattern_shape_map, range_color, color_continuous_midpoint, opacity, orientation, barmode, log_x, log_y, range_x, range_y, text_auto, title, template, width, height)[0m
[1;32m    369[0m     """
[1;32m    370[0m     [0mIn[0m [0ma[0m [0mbar[0m [0mplot[0m[0;34m,[0m [0meach[0m [0mrow[0m [0mof[0m[0;31m [0m[0;31m`[0m[0mdata_frame[0m[0;31m`[0m [0;32mis[0m [0mrepresented[0m [0;32mas[0m [0ma[0m [0mrectangular[0m[0;34m[0m[0;34m[0m[0m
[1;32m    371[0m     [0mmark[0m[0;34m.[0m[0;34m[0m[0;34m[0m[0m
[1;32m    372[0m     """
[0;32m--> 373[0;31m     return make_figure(
[0m[1;32m    374[0m         [0margs[0m[0;34m=[0m[0mlocals[0m[0;34m([0m[0;34m)[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m
[1;32m    375[0m         [0mconstructor[0m[0;34m=[0m[0mgo[0m[0;34m.[0m[0mBar[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m
[1;32m    376[0m         [0mtrace_patch[0m[0;34m=[0m[0mdict[0m[0;34m([0m[0mtextposition[0m[0;34m=[0m[0;34m"auto"[0m[0;34m)[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/plotly/express/_core.py[0m in [0;36m?[0;34m(args, constructor, trace_patch, layout_patch)[0m
[1;32m   2086[0m     [0mtrace_patch[0m [0;34m=[0m [0mtrace_patch[0m [0;32mor[0m [0;34m{[0m[0;34m}[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2087[0m     [0mlayout_patch[0m [0;34m=[0m [0mlayout_patch[0m [0;32mor[0m [0;34m{[0m[0;34m}[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2088[0m     [0mapply_default_cascade[0m[0;34m([0m[0margs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2089[0m [0;34m[0m[0m
[0;32m-> 2090[0;31m     [0margs[0m [0;34m=[0m [0mbuild_dataframe[0m[0;34m([0m[0margs[0m[0;34m,[0m [0mconstructor[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m   2091[0m     [0;32mif[0m [0mconstructor[0m [0;32min[0m [0;34m[[0m[0mgo[0m[0;34m.[0m[0mTreemap[0m[0;34m,[0m [0mgo[0m[0;34m.[0m[0mSunburst[0m[0;34m,[0m [0mgo[0m[0;34m.[0m[0mIcicle[0m[0;34m][0m [0;32mand[0m [0margs[0m[0;34m[[0m[0;34m"path"[0m[0;34m][0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2092[0m         [0margs[0m [0;34m=[0m [0mprocess_dataframe_hierarchy[0m[0;34m([0m[0margs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2093[0m     [0;32mif[0m [0mconstructor[0m [0;32min[0m [0;34m[[0m[0mgo[0m[0;34m.[0m[0mPie[0m[0;34m][0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/plotly/express/_core.py[0m in [0;36m?[0;34m(args, constructor)[0m
[1;32m   1446[0m                 [0margs[0m[0;34m[[0m[0;34m"data_frame"[0m[0;34m][0m [0;34m=[0m [0mdf_not_pandas[0m[0;34m.[0m[0mtoPandas[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1447[0m             [0;32melif[0m [0mhasattr[0m[0;34m([0m[0mdf_not_pandas[0m[0;34m,[0m [0;34m"to_pandas_df"[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1448[0m                 [0margs[0m[0;34m[[0m[0;34m"data_frame"[0m[0;34m][0m [0;34m=[0m [0mdf_not_pandas[0m[0;34m.[0m[0mto_pandas_df[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1449[0m             [0;32melif[0m [0mhasattr[0m[0;34m([0m[0mdf_not_pandas[0m[0;34m,[0m [0;34m"to_pandas"[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m-> 1450[0;31m                 [0margs[0m[0;34m[[0m[0;34m"data_frame"[0m[0;34m][0m [0;34m=[0m [0mdf_not_pandas[0m[0;34m.[0m[0mto_pandas[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m   1451[0m             [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1452[0m                 [0;32mraise[0m [0mexc[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1453[0m [0;34m[0m[0m

[0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/polars/dataframe/frame.py[0m in [0;36m?[0;34m(self, use_pyarrow_extension_array, **kwargs)[0m
[1;32m   2257[0m             return self._to_pandas_with_object_columns(
[1;32m   2258[0m                 [0muse_pyarrow_extension_array[0m[0;34m=[0m[0muse_pyarrow_extension_array[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2259[0m             )
[1;32m   2260[0m [0;34m[0m[0m
[0;32m-> 2261[0;31m         return self._to_pandas_without_object_columns(
[0m[1;32m   2262[0m             [0mself[0m[0;34m,[0m [0muse_pyarrow_extension_array[0m[0;34m=[0m[0muse_pyarrow_extension_array[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2263[0m         )

[0;32m~/.cache/pypoetry/virtualenvs/climate-tutorials-Yg9kLiuM-py3.10/lib/python3.10/site-packages/polars/dataframe/frame.py[0m in [0;36m?[0;34m(self, df, use_pyarrow_extension_array, **kwargs)[0m
[1;32m   2308[0m     ) -> pd.DataFrame:
[1;32m   2309[0m         [0;32mif[0m [0;32mnot[0m [0mdf[0m[0;34m.[0m[0mwidth[0m[0;34m:[0m  [0;31m# Empty dataframe, cannot infer schema from batches[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2310[0m             [0;32mreturn[0m [0mpd[0m[0;34m.[0m[0mDataFrame[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2311[0m [0;34m[0m[0m
[0;32m-> 2312[0;31m         [0mrecord_batches[0m [0;34m=[0m [0mdf[0m[0;34m.[0m[0m_df[0m[0;34m.[0m[0mto_pandas[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m   2313[0m         [0mtbl[0m [0;34m=[0m [0mpa[0m[0;34m.[0m[0mTable[0m[0;34m.[0m[0mfrom_batches[0m[0;34m([0m[0mrecord_batches[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2314[0m         [0;32mif[0m [0muse_pyarrow_extension_array[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m   2315[0m             return tbl.to_pandas(

[0;31mModuleNotFoundError[0m: No module named 'pyarrow'

